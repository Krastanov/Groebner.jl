<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/Groebner.jl/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/Groebner.jl/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/Groebner.jl/css/franklin.css">
<link rel="stylesheet" href="/Groebner.jl/css/poole_hyde.css">
<link rel="stylesheet" href="/Groebner.jl/css/custom.css">
<!-- style adjustments -->
<style>
  html {font-size: 17px;}
  .franklin-content {position: relative; padding-left: 8%; padding-right: 5%;}
  @media (min-width: 940px) {
    .franklin-content {width: 100%; margin-left: auto; margin-right: auto;}
  }
  @media (max-width: 768px) {
    .franklin-content {padding-left: 6%; padding-right: 6%;}
  }
</style>
<link rel="icon" href="/Groebner.jl/assets/favicon.png">

   <title>Groebner.jl — Tutorial</title>  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1 class="sidebar-title"><a href="/Groebner.jl/">Groebner<span style="opacity:0.4">.jl</span></a></h1>
      <br>
    </div>
    <style>
@media (min-width: 768px) {
    .sidebar-nav {
    }
}
    .sidebar .container.sidebar-sticky {
        top: 4rem;
    }
    .sidebar-nav .sidebar-nav-item.active {
        box-sizing: border-box;
        border-bottom: 1px #f1f1f1 solid;
        margin-right: -1em;
        margin-left: -0.5em;
        padding-left: 0.5em;
        color: white;
        font-weight: normal !important;
    }
    .sidebar-nav .sidebar-nav-item {
        color: #cccccc;
        margin: 0.25em 0;
    }
    </style>
    <nav class="sidebar-nav" style="opacity: 0.9">
      <a class="sidebar-nav-item " href="/Groebner.jl/">Home</a>
      <!-- <a class="sidebar-nav-item {{ispage tutorial.html}}active{{end}}" href="/Groebner.jl/tutorial/">Tutorials</a> -->
      <li class="sidebar-nav-item active"><a href="/Groebner.jl/tutorial/">Tutorials</a>
			  <ul class="menu-list-child-list ">
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/" class="menu-list-link">Intro</a>
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/#back_to_the_classics" class="menu-list-link">Back to the Classics</a>
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/#variable_elimination" class="menu-list-link">Variable Elimination</a>
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/#curve_implicitization" class="menu-list-link">Curve Implicitization</a>
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/#system_solving" class="menu-list-link">System Solving</a>
				<li class="menu-list-item active"><a href="/Groebner.jl/tutorial/#graph_coloring" class="menu-list-link">Graph Coloring</a>
				<!-- <li class="menu-list-item {{ispage index.html}}active{{end}}"><a href="/Groebner.jl/tutorial/" class="menu-list-link">Page structure</a> -->
			  </ul>
      <a class="sidebar-nav-item " href="/Groebner.jl/interface/">Interface</a>
    </nav>

  </div>
  <div style="font-size: 0.85em; bottom: 3em; position: fixed">
      <a href="https://github.com/sumiya11/Groebner.jl">Go to GitHub repository &rarr;</a> <br>  <br>

      <a href="https://julialang.org/"><img src="https://raw.githubusercontent.com/JuliaLang/julia-logo-graphics/master/images/julia-logo-dark.svg" height="32" style="display: inline-block; margin-bottom: -8px; opacity: 0.7">
          powered.</a>
  </div>
</div>
<div class="content container">

<!-- Content appended here -->
<div class="franklin-content"><h1 id="tutorials"><a href="#tutorials" class="header-anchor">Tutorials</a></h1>

<h2 id="intro"><a href="#intro" class="header-anchor">Intro</a></h2>
<p>The following contains a small tutorial on basics and interesting usecases of Groebner bases provided with the code from <code>Groebner.jl</code>.</p>
<p>Introduced by Buchberger in 1965 for handling quotient space of Ideals algorithmically, Groebner bases are excellent for <strong>variable elimination, system solving</strong>, and many more. Among others, Groebner bases find applications in</p>
<ul>
<li><p>Robotics</p>
</li>
<li><p>Chemical Reactions Networks Analysis</p>
</li>
<li><p>Control Theory</p>
</li>
<li><p>Cryptography</p>
</li>
</ul>
<p>The following tutorials will give a short introduction to Groebner basis ground theory, and cover some random interesting showcases.</p>
<h3 id="so_what_is_groebner_basis"><a href="#so_what_is_groebner_basis" class="header-anchor">So, what is Groebner basis?</a></h3>
<p><em>In short, a Groebner basis is a good representation of infinite information.</em></p>
<p>A set of polynomials \(F = \{f_1, \ldots, f_m \}\) is said to generate an infinite set \(I\):</p>
\[
  I = \{ f_1h_1 + f_2h_2 + \ldots + f_nh_n ~~|~~ h_i ~arbitrary \}
\]
<p>Such \(I\) is usually called an Ideal generated by \(\{f_i\}\). A Groebner basis of \(I\) is a <em>nicer set of generators</em> for \(I\)</p>
<pre><code class="language-julia">using AbstractAlgebra
_, &#40;x, y&#41; &#61; QQ&#91;&quot;x&quot;, &quot;y&quot;&#93;
F &#61; &#91;x^3 &#43; y^2, x*y &#43; x^2&#93;;</code></pre>
<p>In our example, the Groebner basis for <code>F</code> is</p>
<pre><code class="language-julia">using Groebner
G &#61; groebner&#40;F&#41;</code></pre><pre><code class="plaintext code-output">3-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 y^3 - y^2
 x*y^2 + y^2
 x^2 + x*y</code></pre>
<p>Every set of polynomials &#40;except for zero&#41; has a Groebner basis. Computing a Groebner basis is generally very hard, however, it possess a plenty of nice properties.</p>
<p>First of all, the Groebner basis <strong>is unique</strong>&#33; That is, if two sets of polynomials \(F_1\) and \(F_2\) generate the same ideal &#40;which is actually <strong>infinite</strong>&#41;, then their Groebner bases are the same</p>
<pre><code class="language-julia">F₁ &#61; &#91;x^3 &#43; y^3, x*y &#43; x^2, x^3 - y^2&#93;
F₂ &#61; &#91;x^3 - y^2, x*y &#43; x^2&#93;
groebner&#40;F₁&#41; &#61;&#61; groebner&#40;F₂&#41;</code></pre><pre><code class="plaintext code-output">true</code></pre>
<p>So, a Groebner basis is a unique and convenient representation for symbolic systems, combinatorial relations, and everything else that can be encoded with polynomials.</p>
<p>Secondly, Groebner bases enable an algorithmic way to do <em>multivariate polynomial division by a set</em>. With a polynomial \(f\) and a set of polynomials \(G\), one can divide \(f\) by \(G\) by computing <em>the normal form</em> of \(f\) w.r.t. the Groebner basis of \(G\).</p>
<p><code>Groebner.jl</code> provides normal form functionality with the <code>normalform</code> function.</p>
<pre><code class="language-julia">F &#61; &#91;x^3 &#43; y^2, x*y &#43; x^2&#93;
f &#61; x^4*y^2 &#43; y^3 &#43; x^2 &#43; x*y &#43; 1

G &#61; groebner&#40;F&#41;     # compute the basis
normalform&#40;G, f&#41;    # &quot;divide&quot; f by G</code></pre><pre><code class="plaintext code-output">2*y^2 + 1</code></pre>
<p>The normal form with respect to a Groebner basis is unique, and in turn has nice properties. We will discuss these in the somewhere below.</p>
<h2 id="back_to_the_classics"><a href="#back_to_the_classics" class="header-anchor">Back to the Classics</a></h2>
<p>Computing a Groebner basis for a general system of nonlinear equations is a nontrivial task, both from theoretic and computational perspectives. Still, the two widely known algorithms can give us some intuition behind this process.</p>
<h3 id="groebner_basis_is_gaussian_elimination"><a href="#groebner_basis_is_gaussian_elimination" class="header-anchor">Groebner basis is Gaussian Elimination</a></h3>
<p>If the system <strong>is linear</strong>, then a Groebner basis mirrors the row echelon form of it. That is, computing a Groebner basis is <em>a nonlinear generalization</em> of <em>Gaussian elimination</em> process for systems of algebraic equations. Applied to a linear system, Groebner basis algorithms produce row echelon matrix form</p>
<pre><code class="language-julia">@polyvar x y z
system &#61; &#91;
       x - y &#43; z &#43; 1,
       x &#43; 2y &#43; 3z &#43; 4,
       x &#43; y &#43; 5z &#43; 3
&#93;

groebner&#40;system&#41;  # rref</code></pre><pre><code class="plaintext code-output">3-element Vector{DynamicPolynomials.Polynomial{true, Int64}}:
 z
 y + 1
 x + 2</code></pre>
<h3 id="groebner_basis_is_euclidean_algorithm"><a href="#groebner_basis_is_euclidean_algorithm" class="header-anchor">Groebner basis is Euclidean Algorithm</a></h3>
<p>If the system <strong>is univariate</strong>, then a Groebner basis coincides with the GCD of its generators. One can even say computing a Groebner basis is a multivariate generalization of the Euclidean Algorithm</p>
<pre><code class="language-julia">@polyvar x
f &#61; &#40;x^2 - 1&#41;^7*&#40;x &#43; 3&#41;*&#40;x - 7&#41;^4
g &#61; &#40;x &#43; 3&#41;*&#40;x &#43; 7&#41;

groebner&#40;&#91;f, g&#93;&#41;   # gcd by groebner</code></pre><pre><code class="plaintext code-output">1-element Vector{DynamicPolynomials.Polynomial{true, Int64}}:
 x + 3</code></pre>
<pre><code class="language-julia">gcd&#40;f, g&#41;          # usual gcd</code></pre><pre><code class="plaintext code-output">x + 3</code></pre>
<p>So, you can compute the GCD of several polynomials at once using <code>Groebner.jl</code>&#33; But probably you shouldn&#39;t..</p>
<p>We emphasize, however, that <code>Groebner.jl</code> is designed to have as little runtime overhead as possible over the usual GCD implementation</p>
<pre><code class="language-julia">h &#61; &#40;x &#43; 3&#41;^5

@btime gcd&#40;gcd&#40;&#36;f, &#36;g&#41;, &#36;h&#41;</code></pre><pre><code class="plaintext code-output">  390.601 μs (3816 allocations: 228.98 KiB)
x + 3</code></pre>
<pre><code class="language-julia">F &#61; &#91;f, g, h&#93;
@btime groebner&#40;&#36;F&#41;</code></pre><pre><code class="plaintext code-output">  166.501 μs (1160 allocations: 127.61 KiB)
1-element Vector{DynamicPolynomials.Polynomial{true, Int64}}:
 x + 3</code></pre>
<h2 id="variable_elimination"><a href="#variable_elimination" class="header-anchor">Variable Elimination</a></h2>
<p>With appropriate term orders, one can use Groebner bases to <em>eliminate indeterminates</em> from equations. The main observation here is that</p>
<hr />
<p>If \(G\) is a Groebner basis for some Ideal \(I\) in polynomial ring \(R[x, y, z]\) with variables ordered as \(x > y > z\), then</p>
\[
G \cap R[y, z]
\]
<p>is a Groebner basis for \(I_{y, z}~ =~ I \cap R[y, z]\).</p>
<hr />
<p>Here, one can see \(I_{y, z}\) as a fair geometric projection of solutions of \(I\) onto the last two variables \(y, z\).</p>
<p>For example, consider polynomials in three variables \(x, y, z\)</p>
<pre><code class="language-julia">_, &#40;x, y, z&#41; &#61; QQ&#91;&quot;x&quot;, &quot;y&quot;, &quot;z&quot;&#93;

F &#61; &#91;x^2 &#43; y &#43; z - 1,
     x &#43; y^2 &#43; z - 1,
     x &#43; y &#43; z^2 - 1&#93;</code></pre><pre><code class="plaintext code-output">3-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 x^2 + y + z - 1
 x + y^2 + z - 1
 x + y + z^2 - 1</code></pre>
<p>The Groebner basis is</p>
<pre><code class="language-julia">G &#61; groebner&#40;F&#41;</code></pre><pre><code class="plaintext code-output">4-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 z^6 - 4*z^4 + 4*z^3 - z^2
 y*z^2 + 1//2*z^4 - 1//2*z^2
 y^2 - y - z^2 + z
 x + y + z^2 - 1</code></pre>
<p>Notice that the first three polynomials <code>G&#91;1:3&#93;</code> do not contain <code>x</code>. By the observation, that means the <code>G&#91;1:3&#93;</code> is a Groebner basis for \(I_{y, z}\)</p>
<h2 id="curve_implicitization"><a href="#curve_implicitization" class="header-anchor">Curve Implicitization</a></h2>
<p>Say we have a parametrization of the circle as</p>
\[
x = \frac{1 - t^2}{1 + t^2} ~~~~ y = \frac{2t}{1 + t^2}
\]

and we want to produce an implicit curve equation in $x, y$ *without $t$*. Let's clear denominators

\[
t^2y - 2t + y = 0 ~~~~ t^2x + t^2 + x - 1 = 0
\]
<p>~ y = \frac{2t}{1 + t^2}
\]

and we want to produce an implicit curve equation in $x, y$ *without $t$*. Let's clear denominators

\[
t^2y - 2t + y = 0 ~ t^2x &#43; t^2 &#43; x - 1 &#61; 0 &#93;</p>
<p>The Groebner basis in <code>lex</code> order with \(t > x > y\) is</p>
<pre><code class="language-julia">_, &#40;t, x, y&#41; &#61; QQ&#91;&quot;t&quot;, &quot;x&quot;, &quot;y&quot;&#93;

groebner&#40;&#91;t^2*y - 2t &#43; y, t^2*x &#43; t^2 &#43; x - 1&#93;&#41;</code></pre><pre><code class="plaintext code-output">3-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 x^2 + y^2 - 1
 t*y + x - 1
 t*x + t - y</code></pre>
<p>We see that \(I_{x, y}\) &#61; &#123; x^2 &#43; y^2 - 1 &#125;, so for any \(t\) every \((x, y)\) lies on the circle as expected.</p>
<h2 id="solving_systems"><a href="#solving_systems" class="header-anchor">Solving Systems</a></h2>
<p>In this section we will assume <code>lex</code> term ordering and consider the case with three variables. Same generalizes naturally for \(n\) indeterminates.</p>
<pre><code class="language-julia">_, &#40;x, y, z&#41; &#61; QQ&#91;&quot;x&quot;, &quot;y&quot;, &quot;z&quot;&#93;;</code></pre>
<p>Say we have a polynomial system to solve <em>exactly &#40;symbolically&#41;</em></p>
\[
\begin{aligned}
x + y + z &= 0 \\
xy + xz + yz &= 0 \\
xyz - 1 &= 0 \\
\end{aligned}
\]
<pre><code class="language-julia">sys &#61; &#91;x &#43; y &#43; z,
       x*y &#43; x*z &#43; y*z,
       x*y*z - 1&#93;</code></pre><pre><code class="plaintext code-output">3-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 x + y + z
 x*y + x*z + y*z
 x*y*z - 1</code></pre>
<p>Computing Groebner basis results in</p>
<pre><code class="language-julia">groebner&#40;sys&#41;</code></pre><pre><code class="plaintext code-output">3-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 z^3 - 1
 y^2 + y*z + z^2
 x + y + z</code></pre>
<p>Notice that <code>x^3 - 1</code> in the basis is a <em>univariate equation</em>&#33; Solving it over reals we obtain some roots <code>z &#61; ...</code>.</p>
<p>Then substitute these known <code>z</code> into the second equation <code>y^2 &#43; y*z &#43; z^2</code>, which in turn becomes univariate in <code>y</code>.</p>
<p>Obtaining zeros in <code>y</code>, we move to the next equation in the basis.  </p>
<p>Solving polynomial systems in general using Groebner bases relies on the same technique:</p>
<ol>
<li><p>There is a univariate equation in Groebner basis</p>
</li>
<li><p>Solve it, and substitute found roots into other equations</p>
</li>
<li><p>goto 1.</p>
</li>
</ol>
<p>For the implementation of symbolic system solving check out <code>roots</code> in <code>Symbolics.jl</code> &#33;</p>
<h2 id="graph_coloring"><a href="#graph_coloring" class="header-anchor">Graph Coloring</a></h2>
<p>In graph theory, Graph coloring is a problem of assigning a color to each vertex of a graph in a way that no two neighboring vertices the same color.</p>


<img src="/Groebner.jl/assets/tutorial/code/output/graph2.svg" alt="">
<p>The common hard question is <em>the existence of a proper coloring with \(k\) colors</em> for \(k > 2\). In this section, we will show how the question can be tackled using the Groebner bases approach.</p>
<p>The approach is to</p>
<ul>
<li><p>Establish relation between <em>k-coloring</em> and <em>system of polynomial equations</em></p>
</li>
<li><p>Solve the system or prove unsolvable</p>
</li>
</ul>
<p>There are two types of polynomials forming a typical graph coloring system.</p>
<p>First, for each vertex \(j\) in a graph we assign variable \(x_j\). To fix that each particular vertex \(j\) has a color we construct <em>vertex polynomials</em> of form</p>
\[
x_j^k - 1 = 0
\]
<p>for each vertex \(j\). Then one color out of \(k\) is represented as one of the \(k\)-th roots of unity.</p>
<p>Secondly, we must add <em>edge polynomials</em> polynomials</p>
\[
\frac{x_i^k - x_j^k}{x_i - x_j}
\]
<p>for each \(i \rightarrow j\) in edges to ensure two neighboring vertices do not share the same color. Such polynomial disallows that colors \(x_i\) and \(x_j\) for two neighbors \(i\) and \(j\) coincide.</p>
<p>Finally, solutions of a system constructed this way correspond to proper k-colorings in a 1 to 1 relation.</p>
<p>The coloring system for k&#61;3 in the graph above must contain vertex polynomials</p>
\[
\{ x_1^3 - 1,~ x_2^3 - 1,~ x_3^3 - 1,~ x_4^3 - 1 \}
\]
<p>and a bunch of edge polynomials. Note that adding \(\frac{x_i^3 - x_j^3}{x_i - x_j}\) to a system is equivalent to adding \(x_i^2 + x_ix_j + x_j\).</p>
<pre><code class="language-julia">_, &#40;x1, x2, x3, x4&#41; &#61; QQ&#91;&quot;x1&quot;,&quot;x2&quot;,&quot;x3&quot;,&quot;x4&quot;&#93;

coloring_system &#61; &#91;
  x1^3 - 1, x2^3 - 1, x3^3 - 1, x4^3 - 1,
  x1^2 &#43; x1*x2 &#43; x2^2,
  x1^2 &#43; x1*x3 &#43; x3^2,
  x1^2 &#43; x1*x4 &#43; x4^2,
  x2^2 &#43; x2*x3 &#43; x3^2,
  x3^2 &#43; x3*x4 &#43; x4^2
&#93;

groebner&#40;coloring_system&#41;</code></pre><pre><code class="plaintext code-output">4-element Vector{AbstractAlgebra.Generic.MPoly{Rational{BigInt}}}:
 x4^3 - 1
 x3^2 + x3*x4 + x4^2
 x2 - x4
 x1 + x3 + x4</code></pre>
<p>From the <code>x2 - x4</code> equation we understand 2nd and 4th vertices should be of the same color. It only remains to assign colors to the remaining vertices</p>

<img src="/Groebner.jl/assets/tutorial/code/output/graphcolored.svg" alt="">
<div class="page-foot">
  <div class="copyright">
    &copy; Alexander Demin. Last modified: May 16, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and <a href="https://github.com/tlienart/PkgPage.jl">PkgPage.jl</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
    </div>  <!-- div: content container -->
    
        <script src="/Groebner.jl/libs/katex/katex.min.js"></script>
<script src="/Groebner.jl/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    <script>
        var els =  document.querySelectorAll(".language-julia")
        for (var i=0, l = els.length; i < l; i++) {
            var el = els[i]
            var out = el.parentNode.nextSibling
            if (out.tagName === "PRE") {
                out.className = out.className + " code-output"
            }
        }
    </script>
    
        <script src="/Groebner.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>
